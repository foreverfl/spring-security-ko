[[servlet-authentication-daoauthenticationprovider]]
= DaoAuthenticationProvider
:figures: servlet/authentication/unpwd

{security-api-url}org/springframework/security/authentication/dao/DaoAuthenticationProvider.html[`DaoAuthenticationProvider`]는 xref:servlet/authentication/passwords/user-details-service.adoc#servlet-authentication-userdetailsservice[`UserDetailsService`]와 xref:servlet/authentication/passwords/password-encoder.adoc#servlet-authentication-password-storage[`PasswordEncoder`]를 사용하여 사용자 이름과 비밀번호를 인증하는 xref:servlet/authentication/architecture.adoc#servlet-authentication-authenticationprovider[`AuthenticationProvider`] 구현체입니다.

이 섹션에서는 Spring Security 내에서 ``DaoAuthenticationProvider``가 어떻게 작동하는지 살펴봅니다.
다음 그림은 xref:servlet/authentication/passwords/index.adoc#servlet-authentication-unpwd-input[사용자 이름 및 비밀번호 읽기] 섹션의 그림을 바탕으로 xref:servlet/authentication/architecture.adoc#servlet-authentication-authenticationmanager[`AuthenticationManager`]의 작동 방식을 설명합니다.

.`DaoAuthenticationProvider` 사용
image::{figures}/daoauthenticationprovider.png[]

image:{icondir}/number_1.png[] xref:servlet/authentication/passwords/index.adoc#servlet-authentication-unpwd-input[사용자 이름 및 비밀번호 읽기] 섹션의 인증 ``Filter``는 ``UsernamePasswordAuthenticationToken``을 xref:servlet/authentication/architecture.adoc#servlet-authentication-providermanager[`ProviderManager`]로 구현된 ``AuthenticationManager``에 전달합니다.

image:{icondir}/number_2.png[] ``ProviderManager``는 ``DaoAuthenticationProvider`` 타입의 xref:servlet/authentication/architecture.adoc#servlet-authentication-authenticationprovider[AuthenticationProvider]를 사용하도록 구성됩니다.

image:{icondir}/number_3.png[] ``DaoAuthenticationProvider``는 ``UserDetailsService``에서 ``UserDetails``를 조회합니다.

image:{icondir}/number_4.png[] ``DaoAuthenticationProvider``는 xref:servlet/authentication/passwords/password-encoder.adoc#servlet-authentication-password-storage[`PasswordEncoder`]를 사용하여 이전 단계에서 반환된 ``UserDetails``의 비밀번호를 검증합니다.

image:{icondir}/number_5.png[] 인증이 성공하면, 반환되는 xref:servlet/authentication/architecture.adoc#servlet-authentication-authentication[`Authentication`]은 ``UsernamePasswordAuthenticationToken`` 타입이며, 그 principal은 구성된 ``UserDetailsService``에서 반환한 ``UserDetails``입니다.
최종적으로, 반환된 ``UsernamePasswordAuthenticationToken``은 인증 ``Filter``에 의해 xref:servlet/authentication/architecture.adoc#servlet-authentication-securitycontextholder[`SecurityContextHolder`]에 설정됩니다.